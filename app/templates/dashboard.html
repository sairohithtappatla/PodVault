{% extends "base.html" %}

{% block extra_css %}
<style>
  .dashboard-title {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    margin-bottom: 2rem;
    border: 1px solid #e1e8ed;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  .dashboard-title h1 {
    color: #2c3e50;
    font-size: 1.8rem;
    font-weight: 600;
  }

  .stats-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .stat-box {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    border: 1px solid #e1e8ed;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    text-align: center;
  }

  .stat-box h2 {
    font-size: 2.5rem;
    color: #2c3e50;
    margin-bottom: 0.5rem;
    font-weight: 700;
  }

  .stat-box p {
    color: #7f8c8d;
    font-size: 0.95rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 500;
  }

  .chart-section {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    border: 1px solid #e1e8ed;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  .chart-section h3 {
    color: #2c3e50;
    font-size: 1.3rem;
    margin-bottom: 1.5rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .chart-section h3 i {
    color: #3498db;
  }

  .back-link {
    margin-top: 2rem;
    text-align: center;
  }

  .back-link a {
    color: #3498db;
    text-decoration: none;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    gap: 6px;
  }

  .back-link a:hover {
    text-decoration: underline;
  }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-title">
  <h1>ðŸ“Š Analytics Dashboard</h1>
</div>

<div class="stats-row">
  <div class="stat-box">
    <h2>{{ total_vaults }}</h2>
    <p>Total Vaults</p>
  </div>
  <div class="stat-box">
    <h2>{{ total_files }}</h2>
    <p>Your Files</p>
  </div>
  <div class="stat-box">
    <h2>{{ total_logs }}</h2>
    <p>Total Actions</p>
  </div>
</div>

<div class="chart-section">
  <h3><i class="fas fa-chart-bar"></i> Recent Activity</h3>
  <canvas id="logChart" width="400" height="200"></canvas>
</div>

<div class="back-link">
  <a href="/home"><i class="fas fa-arrow-left"></i> Back to Home</a>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const labels = {{ logs | map(attribute = 'action') | list | tojson | safe }};
  const dataPoints = {{ range(1, logs | length + 1) | list | tojson | safe }};

  const ctx = document.getElementById('logChart').getContext('2d');
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [{
        label: 'Actions',
        data: dataPoints,
        backgroundColor: '#3498db',
        borderRadius: 6
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { display: false }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: { stepSize: 1 }
        }
      }
    }
  });
</script>
{% endblock %}